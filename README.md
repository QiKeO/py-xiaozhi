# 小智语音助手

一个基于云端 AI 的智能语音交互助手，支持实时对话。

## 主要功能

- 🎤 实时语音对话
- 🤖 智能 AI 回复
- 🔐 加密数据传输
- 🎵 语音播放

## 技术特点

- MQTT 消息通信
- UDP 音频传输
- AES-CTR 加密
- Opus 音频编解码

## 运行环境要求

- Python 3.12+
- Windows 系统
- 麦克风和扬声器设备
- 网络连接

## 安装步骤

1. 克隆项目：

```bash
git clone https://github.com/QiKeO/py-xiaozhi.git
cd py-xiaozhi
```

2. 安装依赖：

```bash
pip install -r requirements.txt
```

3. 安装 opus.dll：

- 将 opus.dll 复制到 C:\Windows\System32 目录下

## 使用方法

1. 启动程序：

```bash
python py-xiaozhi.py
```

2. 首次使用：

- 程序会提供验证码
- 访问控制台：https://xiaozhi.me/console/devices
- 输入验证码完成设备添加
- 重启程序即可使用

3. 操作说明：

- 按住空格键 🎤 - 开始说话
- 松开空格键 💭 - 等待回复
- ESC 键 ❌ - 退出程序

## 界面说明

程序使用彩色文字和图标提示当前状态：

- 🟢 绿色文字 - 用户输入
- 🔵 蓝色文字 - AI 回复
- ⚫ 灰色文字 - 系统状态
- 🔴 红色文字 - 错误提示

状态图标：

- 🎤 正在录音
- 💭 正在思考
- ▶️ 正在播放
- ⏸️ 播放暂停
- ✓ 已识别
- 🤖 AI 回复

## 常见问题

1. 启动报错：

   - 检查是否已安装 opus.dll
   - 确认麦克风和扬声器是否正常工作
   - 检查网络连接是否正常

2. 无法连接服务器：

   - 检查网络连接
   - 确认设备是否已在控制台添加
   - 重启程序重试

3. 音频问题：
   - 检查系统音量设置
   - 确认麦克风权限已开启
   - 检查音频设备是否被其他程序占用

## 注意事项

1. 首次运行需要联网
2. 确保麦克风权限已开启
3. 保持网络连接稳定
4. 按 ESC 键可安全退出

## 功能示例

1. 音乐播放：

```
用户：播放周杰伦的晴天
小智：好的，这是周杰伦的《晴天》
```

2. 智能对话：

```
用户：今天天气怎么样？
小智：让我看看...今天天气晴朗，气温适宜
```

## 依赖说明

主要依赖包：

- paho-mqtt >= 1.6.1 - MQTT 通信
- pyaudio >= 0.2.13 - 音频处理
- opuslib >= 3.0.1 - 音频编解码
- cryptography >= 41.0.0 - 加密功能
- pynput >= 1.7.6 - 键盘监听
- colorama >= 0.4.6 - 终端彩色显示
- requests >= 2.31.0 - HTTP 请求

## 开发说明

1. 代码结构：

- py-xiaozhi.py - 主程序
- requirements.txt - 依赖配置
- README.md - 使用文档

2. 通信协议：

- MQTT：消息传递
- UDP：音频传输

3. 安全机制：

- TLS 加密 MQTT 通信
- AES-CTR 加密音频数据
- 动态会话管理

## 更新日志

### v1.0.0

- ✨ 实现基础语音对话
- 🎨 添加彩色界面提示
- 🔒 加入数据加密传输
- 🎵 支持音乐播放功能
- 🔧 优化错误处理机制
